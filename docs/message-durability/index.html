<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.2">
<link rel="search" type="application/opensearchdescription+xml" title=".NET Client for ActiveMQ Artemis" href="/dotnet-activemq-artemis-client/opensearch.xml"><title data-react-helmet="true">Message Durability Modes | .NET Client for ActiveMQ Artemis</title><meta data-react-helmet="true" property="og:url" content="https://havret.github.io/dotnet-activemq-artemis-client/dotnet-activemq-artemis-client/docs/message-durability"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Message Durability Modes | .NET Client for ActiveMQ Artemis"><meta data-react-helmet="true" name="description" content="ActiveMQ Artemis supports two types of durability modes for messages: durable and nondurable. By default each message sent by the client using SendAsync method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can await for."><meta data-react-helmet="true" property="og:description" content="ActiveMQ Artemis supports two types of durability modes for messages: durable and nondurable. By default each message sent by the client using SendAsync method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can await for."><link data-react-helmet="true" rel="shortcut icon" href="/dotnet-activemq-artemis-client/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://havret.github.io/dotnet-activemq-artemis-client/dotnet-activemq-artemis-client/docs/message-durability"><link data-react-helmet="true" rel="alternate" href="https://havret.github.io/dotnet-activemq-artemis-client/dotnet-activemq-artemis-client/docs/message-durability" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://havret.github.io/dotnet-activemq-artemis-client/dotnet-activemq-artemis-client/docs/message-durability" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/dotnet-activemq-artemis-client/assets/css/styles.285d0b64.css">
<link rel="preload" href="/dotnet-activemq-artemis-client/assets/js/runtime~main.198e3c67.js" as="script">
<link rel="preload" href="/dotnet-activemq-artemis-client/assets/js/main.09c92fa0.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" role="banner"><div class="announcementBarContent_3EUC announcementBarCloseable_3myR">‚≠êÔ∏è If you like .NET Client for ActiveMQ Artemis, give it a star on <a target="_blank" rel="noopener noreferrer" href="https://github.com/Havret/dotnet-activemq-artemis-client">GitHub</a>! ‚≠êÔ∏è</div><button type="button" class="announcementBarClose_38nx clean-btn" aria-label="Close"><span aria-hidden="true">√ó</span></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/dotnet-activemq-artemis-client/"><img src="/dotnet-activemq-artemis-client/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/dotnet-activemq-artemis-client/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">.NET Client for ActiveMQ Artemis</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/dotnet-activemq-artemis-client/docs/getting-started">Docs</a><a href="https://github.com/Havret/dotnet-activemq-artemis-client" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><a href="https://www.nuget.org/packages/ArtemisNetClient" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Download</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/dotnet-activemq-artemis-client/"><img src="/dotnet-activemq-artemis-client/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/dotnet-activemq-artemis-client/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">.NET Client for ActiveMQ Artemis</b></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/dotnet-activemq-artemis-client/docs/getting-started">Docs</a></li><li class="menu__list-item"><a href="https://github.com/Havret/dotnet-activemq-artemis-client" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li><li class="menu__list-item"><a href="https://www.nuget.org/packages/ArtemisNetClient" target="_blank" rel="noopener noreferrer" class="menu__link">Download</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu menu--responsive thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA" aria-label="Sidebar navigation"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dotnet-activemq-artemis-client/docs/getting-started">Getting Started</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dotnet-activemq-artemis-client/docs/message-payload">Message payload</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/dotnet-activemq-artemis-client/docs/message-durability">Message Durability</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dotnet-activemq-artemis-client/docs/message-priority">Message Priority</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dotnet-activemq-artemis-client/docs/consumer-credit">Consumer credit</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/dotnet-activemq-artemis-client/docs/auto-recovery">Automatic Recovery</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Community</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/dotnet-activemq-artemis-client/docs/online-resources">Online resources</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="markdown"><header><h1 class="h1Heading_27L5">Message Durability Modes</h1></header><p>ActiveMQ Artemis supports two types of durability modes for messages: <code>durable</code> and <code>nondurable</code>. By default each message sent by the client using <code>SendAsync</code> method is durable. That means that the broker actually has to persist the message on the disk before the confirmation frame (ack) will be sent back to the client. The confirmation frame is what we can <em>await</em> for.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">await producer.SendAsync(new Message(&quot;foo&quot;)</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>When <code>SendAsync</code> completes without errors we may expect that the message will be delivered with <em>at least once</em> semantics. Durable messages incur more overhead due to the need to store the message, and value reliability over performance.</p><p>Setting message durability mode to <code>Nondurable</code> instructs the broker not to persist the message. By default each message sent by the client using <code>Send</code> method is nondurable. <code>Send</code> is non-blocking both in terms of packets transmission (it uses <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.sockets.socket.sendasync" target="_blank" rel="noopener noreferrer">Socket.SendAsync</a> method in the fire and forget manner) and in terms of waiting for confirmation from the broker (it doesn&#x27;t). As a result, <em>at most once</em> is all that you can expect in terms of message delivery guarantees from this combination. Nondurable messages incur less overhead and value performance over reliability.</p><p>Default message durability settings may be overridden via producer configuration:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">var producer = await connection.CreateProducerAsync(new ProducerConfiguration</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    Address = &quot;a1&quot;,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    RoutingType = RoutingType.Anycast,</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    MessageDurabilityMode = DurabilityMode.Nondurable</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And for each message individually:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_23N8 thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#bfc7d5"><span class="token plain">await producer.SendAsync(new Message(&quot;foo&quot;)</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    DurabilityMode = DurabilityMode.Nondurable // takes precedence over durability</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                                               // mode specified on the producer level</span></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/Havret/dotnet-activemq-artemis-client/edit/master/website/../docs/message-durability.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/dotnet-activemq-artemis-client/docs/message-payload"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Message payload</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/dotnet-activemq-artemis-client/docs/message-priority"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Message Priority ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/dotnet-activemq-artemis-client/docs/getting-started">Get Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/Havret/dotnet-activemq-artemis-client" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 Havret. Built with Docusaurus.</div></div></div></footer></div>
<script src="/dotnet-activemq-artemis-client/assets/js/runtime~main.198e3c67.js"></script>
<script src="/dotnet-activemq-artemis-client/assets/js/main.09c92fa0.js"></script>
</body>
</html>